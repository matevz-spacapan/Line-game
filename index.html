<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bounce test</title>
  <!--Bootstrap-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <!--jQuery-->
  <!--<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
  <!--<script src="./js/polyfill.js" type="text/javascript"></script>-->
  <script src="./js/arucocv.js" type="text/javascript"></script>
  <script src="./js/opencv.js" type="text/javascript"></script>
  <script src="./js/aruco.js" type="text/javascript"></script>
  <script src="./js/main.js" type="text/javascript"></script>
</head>
<body onload="init()">
  <div id="container-fluid">
    <!-- Game canvas -->
    <div class="d-flex justify-content-around align-items-center align-self-center">
      <canvas id="canvas" width="1280" height="960" style="border: 1px solid blue;" class="mt-3"></canvas>
      <div class="text-center" style="max-width: 900px;">
        <h5>AR ball bouncing game</h5>
        <p>This game is supposed to be played by <b>two players</b>. The first player will look at the screen, the second will draw lines on paper as instructed by the first player. The goal is to bounce the ball with drawn lines on the paper to the finish area (green square). Here's how to play:</p>
        <ol class="text-start">
          <li>Download and print (on <b>A4 format</b> for best results) <a href="Template.pdf" download>this template</a>. You don't have to print all pages, but any one will be fine. The game uses special markers on it to recognise the drawing area.
          </li>
          <li>No matter how you rotate the paper to the camera, the software will always know the correct rotation. This means the top of the paper (<b class="text-danger">TEMPLATE NEEDS TEXT OR ARROW SHOWING THIS</b>) is also the top of the play area on the screen.</li>
          <li>When drawing, cover at least one marker, so your hand won't be accidentially recognised as a drawn line.</li>
          <li>The player viewing the screen should point the camera on the paper in such a way so that all 4 corner markers are visible and recognised (on the camera view you'll see a red box around recognised markers).</li>
          <li>If you make a mistake on the paper, then you'll need to print a new sheet.</li>
        </ol>
        <p>The game has <b>3 levels</b>, so print the template at least 3 times - 1 sheet for each level. You may use the following colored markers for drawing:</p>
        <ul class="text-start">
          <li><b>BLACK</b>: bounces the ball with no special effects.</li>
          <li><b class="text-danger">RED</b>: bounces the ball and makes it a bit smaller.</li>
          <li><b class="">COLOR</b>: bounces the ball and makes it a bit slower.</li>
        </ul>
        <p>Pay attention to the size of the ball and finish area - it may happen that you'll <b>have to</b> shrink the ball to fit into it.</p>
        <p>If the ball is too slow, you may press the buttons bellow to speed it up.</p>
        <button id="normal" type="button" class="btn btn-primary" onclick="speed(1)" disabled>Default speed</button>
        <button id="twox" type="button" class="btn btn-primary" onclick="speed(2)">2x speed</button>
        <button id="fourx" type="button" class="btn btn-primary" onclick="speed(4)">4x speed</button><br><br>
        <p>If the ball gets stuck, you can <button type="button" class="btn btn-link" onclick="resetBall()">reset it</button> back to the start or <button type="button" class="btn btn-link" onclick="resetLines()">clear your lines</button>.</p>
      </div>
    </div>
    <div class="row my-3 text-center">
      <!-- Debug - camera view -->
      <div class="col">
        <video id="video" autoplay="true" style="display:none;" width="320" height="240"></video>
        <canvas id="debug_cam" style="border: 3px solid green;" width="320" height="240"></canvas>
        <p>Debug: camera</p>
      </div>
      <!-- Debug - aruco detection -->
      <div class="col">
        <canvas id="debug1" style="border: 3px solid red;" width="320" height="240"></canvas>
        <p>Debug: Aruco detector</p>
      </div>
      <!-- Debug - crop camera view to inside of aruco markers -->
      <div class="col">
        <canvas id="debug2" style="border: 3px solid blue;" width="320" height="240"></canvas>
        <p>Debug: Crop</p>
      </div>
      <!-- Debug - detected lines inside aruco markers -->
      <div class="col">
        <canvas id="debug3" style="border: 3px solid pink;" width="320" height="240"></canvas>
        <p>Debug: Lines</p>
      </div>
      <div class="col" style="display:none;">
        <canvas id="debug4" style="border: 3px solid pink;" width="320" height="240"></canvas>
        <p>Debug</p>
      </div>
    </div>
  </div>
  <footer class="text-center">© 2020-2021 Matevž Špacapan (programming), Bronislav Musil (design)</footer>
</body>
</html>
